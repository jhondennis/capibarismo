---
import LanguageSwitcher from "./LanguageSwitcher.astro";
import { getLangFromUrl, useTranslations } from "../i18n/utils";
import ThemeToggle from "./ThemeToggle.astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<header
  class="sticky top-0 z-50 bg-warm-50/80 dark:bg-warm-900/80 backdrop-blur-md border-b border-warm-200 dark:border-warm-800"
>
  <div class="container mx-auto px-4 py-4 flex items-center justify-between">
    <a href="/" class="flex items-center gap-2 group">
      <div
        class="w-10 h-10 rounded-full bg-warm-200 dark:bg-warm-800 flex items-center justify-center overflow-hidden group-hover:scale-110 transition-transform"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="w-6 h-6"
        >
          <circle cx="12" cy="12" r="10"></circle>
          <circle cx="8" cy="9" r="1"></circle>
          <circle cx="16" cy="9" r="1"></circle>
          <path d="M9 16c.85.63 1.9 1 3 1s2.15-.37 3-1"></path>
        </svg>
      </div>
      <span class="font-bold text-xl tracking-tight">Capivarismo</span>
    </a>

    <nav class="hidden md:flex items-center gap-6">
      <a href="#about" class="nav-link">{t("nav.about")}</a>
      <a href="#news" class="nav-link">{t("nav.news")}</a>
      <a href="#videos" class="nav-link">{t("nav.videos")}</a>
    </nav>

    <div class="flex items-center gap-3">
      <LanguageSwitcher />
      <ThemeToggle />

      <a
        href="https://github.com/jhondennis/capibarismo"
        target="_blank"
        rel="noopener noreferrer"
        class="p-2 rounded-full hover:bg-warm-200 dark:hover:bg-warm-800 transition-colors"
        aria-label="GitHub Repository"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="w-5 h-5"
        >
          <path
            d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
          ></path>
        </svg>
      </a>

      <a
        href="https://buymeacoffee.com/dennislaurel"
        target="_blank"
        rel="noopener noreferrer"
        class="hidden md:flex items-center gap-2 px-4 py-2 bg-[#FFDD00] text-[#000000] rounded-full font-medium hover:bg-[#FFDD00]/90 transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="w-4 h-4"
        >
          <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
          <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
          <line x1="6" y1="1" x2="6" y2="4"></line>
          <line x1="10" y1="1" x2="10" y2="4"></line>
          <line x1="14" y1="1" x2="14" y2="4"></line>
        </svg>
        <span>Buy me a coffee</span>
      </a>

      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2 rounded-full hover:bg-warm-200 dark:hover:bg-warm-800 transition-colors"
        aria-label="Toggle menu"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="w-6 h-6"
        >
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <div
    id="mobile-menu"
    class="hidden md:hidden container mx-auto px-4 py-4 border-t border-warm-200 dark:border-warm-800"
  >
    <nav class="flex flex-col gap-4">
      <a href="#about" class="nav-link">{t("nav.about")}</a>
      <a href="#news" class="nav-link">{t("nav.news")}</a>
      <a href="#videos" class="nav-link">{t("nav.videos")}</a>
      <a
        href="https://buymeacoffee.com/dennislaurel"
        target="_blank"
        rel="noopener noreferrer"
        class="flex items-center gap-2 px-4 py-2 bg-[#FFDD00] text-[#000000] rounded-full font-medium hover:bg-[#FFDD00]/90 transition-colors w-fit"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="w-4 h-4"
        >
          <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
          <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
          <line x1="6" y1="1" x2="6" y2="4"></line>
          <line x1="10" y1="1" x2="10" y2="4"></line>
          <line x1="14" y1="1" x2="14" y2="4"></line>
        </svg>
        <span>Buy me a coffee</span>
      </a>
    </nav>
  </div>
</header>

<script>
  // Mobile menu toggle
  document.addEventListener("DOMContentLoaded", () => {
    const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");

    if (mobileMenuToggle && mobileMenu) {
      mobileMenuToggle.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
      });
    }
  });
</script>

<style>
  .nav-link {
    position: relative;
    font-weight: var(--font-weight-medium);
  }

  .nav-link::after {
    content: "";
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: currentColor;
    transition: width 0.3s ease;
  }

  .nav-link:hover::after {
    width: 100%;
  }
</style>
